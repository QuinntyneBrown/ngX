<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Component LifeCycle</title>
</head>
<body data-ng-app="app">

    <my-app></my-app>

    <script src="../../node_modules/angular/angular.min.js"></script>
    <script src="../../node_modules/angular-route/angular-route.min.js"></script>
    <script src="../../dist/ngX.js"></script>
    <script>
        angular.module("app", ["ngX"])
            .config(["$routeProvider", function ($routeProvider) {
                $routeProvider.when("/", { 
                    componentName: "homeComponent", 
                    componentTemplateUrl: "/examples/componentLifeCycle/home.component.html"
                });

                $routeProvider.when("/about", {
                    componentName: "aboutComponent",
                    componentTemplateUrl: "/examples/componentLifeCycle/about.component.html"
                });
            }]);

        function HomeComponent($q) {

            return {
                title: "Home",
                onInit: function () { alert("onInit"); },
                canDeactivate: function () { 
                    alert("canDeactivate");
                    return $q.when(true);
                },
                deactivate: function () { alert("deactivate"); }
            }
        }

        /* static */
        HomeComponent.canActivate = function () {
            return ["$q", function ($q) {
                alert("can Activate!");
                setTimeout(function() { return $q.when({ value: 1}); }, 1000);
            }];
        }
            
        ngX.Component({
            component: HomeComponent,
            componentName: "homeComponent",
            providers:["$q"],
            route: "/",
            key: "home"
        });

        function AboutComponent() {
            return { title: "About" }
        }

        ngX.Component({
            component: AboutComponent,
            componentName: "aboutComponent"
        });


        function AppComponent() {}

        ngX.Component({
            selector: "my-app",
            component: AppComponent,
            template: [
                "<div>",
                "<app-header/>",
                "<div data-ng-view></div>",
                "</div>"
            ].join(" ")
        });

        function HeaderComponent() { }

        ngX.Component({
            selector: "app-header",
            component: HeaderComponent,
            template: [
                "<div>",
                "<a href='#/'>Home</a>",
                "<a href='#/about'>About</a>",
                "</div>"
            ].join(" ")
        });


    </script>
</body>
</html>
